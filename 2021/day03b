#!/usr/bin/awk -f

function narrow(a, b,    c, d) {
	if (length(a) > 1) {
		for (value in a) {
			$0 = value
			c[$i]++
		}
		if (b)
			d = c[1] >= length(a) / 2
		else
			d = c[0] <= length(a) / 2
		for (value in a) {
			$0 = value
			if ($i == (d ? !b : b)) {
				delete a[value]
			}
		}
	}
}

BEGIN { FS = "" }
      { co2[$0] = oxygen[$0] = 1 }
END   {
	for (i = 1; (length(oxygen) * length(co2)) > 1; i++) {
		narrow(oxygen, 1)
		narrow(co2, 0)
	}
	for (value in oxygen) split(value, v1, "")
	for (value in co2)    split(value, v2, "")
	for (i = 1; i <= NF; i++) {
		m *= 2; n *= 2;
		if (v1[i]) m++
		if (v2[i]) n++
	}
	print n * m
}
